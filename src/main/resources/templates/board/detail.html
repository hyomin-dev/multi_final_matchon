<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>상세보기</title>
    <style>
        body { font-family: Arial; background: #f4f4f4; padding: 30px; }
        .container {
            max-width: 700px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 { margin-bottom: 10px; }
        .meta { color: gray; font-size: 0.9em; }
        .content { margin: 20px 0; white-space: pre-line; }
        .files ul { list-style: disc; margin-left: 20px; }
        a.download { color: #007BFF; text-decoration: none; }
        button { margin-left: 10px; }
    </style>
</head>
<body>
<div class="container">
    <h1 th:text="${board.title}">제목</h1>
    <div class="meta">
        작성자: <span th:text="${board.author}"></span> |
        작성일: <span th:text="${#temporals.format(board.createdAt, 'yyyy-MM-dd HH:mm')}"></span>
    </div>
    <div class="content" th:text="${board.content}"></div>

    <div class="files" th:if="${board.filename}">
        <p>첨부파일:</p>
        <ul>
            <li th:each="file : ${#strings.arraySplit(board.filename, ',')}" th:id="${'file-' + file}">
                <a class="download" th:href="@{'/download/' + ${file}}" th:text="${file}"></a>
                <button type="button" th:onclick="'deleteFile(' + ${board.id} + ', \'${file}\')'">❌ 삭제</button>
            </li>
        </ul>
    </div>

    <a href="/" style="display:block; margin-top:20px;">← 목록으로</a>
</div>

<script>
    function deleteFile(postId, filename) {
        if (!confirm(filename + ' 파일을 삭제하시겠습니까?')) return;
        fetch(`/post/${postId}/delete-file`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: 'filename=' + encodeURIComponent(filename)
        }).then(response => {
            if (response.ok) {
                alert('삭제되었습니다.');
                document.getElementById('file-' + filename).remove();
            } else {
                alert('삭제 실패');
            }
        });
    }
</script>
</body>
</html>

